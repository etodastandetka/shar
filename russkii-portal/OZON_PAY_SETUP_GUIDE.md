# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Ozon Pay

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏ Ozon Pay)

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –õ–ö Ozon –ë–∞–Ω–∫–∞

1. **–ó–∞–π–¥–∏—Ç–µ –≤ –õ–ö Ozon –ë–∞–Ω–∫–∞** 
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ú–∞–≥–∞–∑–∏–Ω" ‚Üí "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"**
3. **–ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω"**
4. **–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞** –∏ –≤—ã–±–µ—Ä–∏—Ç–µ **"–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è"**
5. **–î–æ–±–∞–≤—å—Ç–µ URL-–∞–¥—Ä–µ—Å–∞:**
   - **URL —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã:** `https://yourdomain.com/payment/success`
   - **URL –Ω–µ—É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã:** `https://yourdomain.com/payment/fail`
   - **URL –¥–ª—è POST-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:** `https://yourdomain.com/api/ozonpay/webhook`
6. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ** —Å –ø–æ–º–æ—â—å—é SMS-–∫–æ–¥–∞
7. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏** –∏–∑ –æ–∫–Ω–∞ "–î–∞–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω–∞":
   - **AccessKey** (ca10c60b-6c30-4e9d-ac21-d52d497ff31f)
   - **SecretKey** (1kZ1ZiPDDxVy0JlWsG4v14EhRIGOTYmK)
   - **NotificationSecretKey** (avUNhUZku6o0FYLtTxwYZrni6ODUgxdN)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# Ozon Pay API Configuration (–æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
# –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –õ–ö Ozon –ë–∞–Ω–∫–∞
OZONPAY_ACCESS_KEY=your_access_key_here
OZONPAY_SECRET_KEY=your_secret_key_here
OZONPAY_NOTIFICATION_SECRET_KEY=your_notification_secret_key_here
OZONPAY_API_URL=https://payapi.ozon.ru/v1
OZONPAY_SUCCESS_URL=https://yourdomain.com/payment/success
OZONPAY_FAIL_URL=https://yourdomain.com/payment/fail
OZONPAY_WEBHOOK_URL=https://yourdomain.com/api/ozonpay/webhook

# –î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
DATABASE_URL=sqlite:./db/database.sqlite
JWT_SECRET=your_jwt_secret_here
PORT=5000
NODE_ENV=development
```

### 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥–∞

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—ç–∫–≤–∞–π—Ä–∏–Ω–≥ –ø—É—Ç—ë–º –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±–æ–µ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –Ω–∞ —Å—É–º–º—É –æ—Ç 10 —Ä—É–±–ª–µ–π.

**–ö–∞–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:**
1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ —Å—É–º–º—É 10 —Ä—É–±–ª–µ–π
2. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –æ–ø–ª–∞—Ç—É
3. –£–≤–µ–¥–æ–º–∏—Ç–µ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É Ozon Pay –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ù–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ `server/ozonpay.ts` –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

‚úÖ **–ì–æ—Ç–æ–≤–æ:**
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π API URL: `https://payapi.ozon.ru/v1`
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ createOrder
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook'–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π (AccessKey, SecretKey, NotificationSecretKey)

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:** `npm run dev`
2. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑** —Å –æ–ø–ª–∞—Ç–æ–π —á–µ—Ä–µ–∑ Ozon Pay
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫
4. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø–æ–ª—É—á–µ–Ω–∏–∏ webhook'–æ–≤**

**–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞:** `4111 1111 1111 1111`, `01/28`, `111`

### 6. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å AccessKey, SecretKey –∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–¥–ø–∏—Å–∏

#### –ü—Ä–æ–±–ª–µ–º–∞: Webhook –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL webhook –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç —Å—Ç–∞—Ç—É—Å–æ–º 200

#### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–≤–µ—Ä–Ω–∞—è –ø–æ–¥–ø–∏—Å—å
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ NotificationSecretKey –∏ –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ webhook

### 7. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ API

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:**
```json
{
  "accessKey": "ca10c60b-6c30-4e9d-ac21-d52d497ff31f",
  "amount": {
    "currencyCode": "643",
    "value": 5500
  },
  "enableFiscalization": false,
  "extId": "45",
  "fiscalizationType": "FISCAL_TYPE_SINGLE",
  "paymentAlgorithm": "PAY_ALGO_SMS",
  "successUrl": "https://mysite.ozon.ru/?good",
  "failUrl": "https://mysite.ozon.ru/?bad",
  "receiptEmail": "email@ozon.ru",
  "notificationUrl": "https://webhook.site/4a30efd7-b1c1-469f-a337-e2fe1411f9f3",
  "requestSign": "c4871a9576a368ae95cb279f2fb6dcfef8884ab6c7af4b0dfceb591cbf835bc3",
  "items": [...]
}
```

**–ü–æ–¥–ø–∏—Å—å webhook:**
```
SHA256(accessKey|orderID|transactionID|extOrderID|amount|currencyCode|notificationSecretKey)
```

### 8. –ö–æ–Ω—Ç–∞–∫—Ç—ã —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–µ Ozon Pay, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∞ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á–∏ –≤ –õ–ö Ozon –ë–∞–Ω–∫–∞ (AccessKey, SecretKey, NotificationSecretKey)
2. –ó–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `.env` —Ñ–∞–π–ª–µ  
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run dev`
4. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Ω–∞ 10 —Ä—É–±–ª–µ–π
5. –ì–æ—Ç–æ–≤–æ! üéâ 